### 《深入剖析 Kubernetes》学习笔记 Day 50

「52 | 答疑：在问题中解决问题，在思考中产生思考」

#### 前文回顾

详细地讲解了 Kubernetes 开源社区运作方式和未来走向.

#### 在问题中解决问题，在思考中产生思考

本文的问题很具体，如果不是亲身实践遇到，帮助不会太多。

摘录了几条自己感兴趣的。

**Copy-on-Write**

修改一个镜像里的文件的时候，联合文件系统首先会从上到下在各个层中查找有没有目标文件。如果找到，就把这个文件复制到可读写层进行修改。这个修改的结果会屏蔽掉下层的文件。

**控制器模式和事件驱动**

对于控制器来说，被监听对象的变化是一个持续的信号，比如变成 ADD 状态。只要这个状态没变化，那么此后无论何时去查询对象的状态，都应该是 ADD。

对于事件驱动来说，只会在 ADD 事件发生的时候发出一个事件。如果错过了这个事件，那么就有可能再也没办法知道 ADD 这个事件的发生了。

**三层网络方案和隧道模式**

隧道模式最大的特点，在于需要通过某种方式比如 UDP 或者 VXLAN 来对原始网络包进行封装，然后伪装成宿主机间的网络通信来完成容器跨主通信。封包和解包这两个操作的性能损耗非常明显。三层网络方案则避免了这个过程，所以性能会得到很大的提升。

隧道模式的优点在于，它依赖的底层原理非常直白，内核里的实现也非常成熟和稳定。而三层网络方案，相对来说维护成本会比较高，容易碰到路由规则分发和设置出现问题的情况，并且当容器数量很多时，宿主机上的路由规则会非常复杂，难以 Debug。

**Kubernetes VS OpenStack**

OpenStack 社区非常强调民主化，治理方式相对松散，导致它在治理上没能把主线和旁线分开，政治和技术也没有隔离。这使得后期大量的低价值或者周边型的项目不断冲进 OpenStack 社区，大大降低了社区的含金量，并且分散了大量的社区精力在这些价值相对不高的项目上，从而拖慢并干扰了比如 Cinder、Neutron 等核心项目的演进步伐和方向，最终使得整个社区在容器的热潮下难以掉头，不可避免地走向了下滑的态势。

相比之下，CNCF 基金会成功地帮助 Kubernetes 社区分流了低价值以及周边型项目的干扰，并且完全承接了 Marketing 的角色，使得 Kubernetes 社区在后面大量玩家涌入的时候，依然能够专注在主线的演进上。

> 感悟：不去实践就不会有问题，没有问题就不会引发思考，不思考就不会成长！

学习来源： 极客时间 https://time.geekbang.org/column/intro/100015201?tab=catalog


